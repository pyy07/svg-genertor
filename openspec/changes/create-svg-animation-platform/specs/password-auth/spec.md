## ADDED Requirements

### Requirement: 用户使用次数限制
系统 SHALL 跟踪每个登录用户的 SVG 生成使用次数，默认每个用户可以使用 3 次。

#### Scenario: 用户首次生成 SVG
- **WHEN** 已登录用户请求生成 SVG
- **AND** 用户使用次数未超过限制（默认 3 次）
- **THEN** 系统允许生成 SVG
- **AND** 用户使用次数增加 1
- **AND** 返回生成的 SVG 代码

#### Scenario: 用户使用次数超限
- **WHEN** 已登录用户请求生成 SVG
- **AND** 用户已使用 3 次
- **THEN** 系统拒绝请求
- **AND** 返回使用次数已用完的错误信息
- **AND** 提示用户联系管理员增加次数

#### Scenario: 永久用户无限制使用
- **WHEN** 已登录的永久用户请求生成 SVG
- **THEN** 系统允许生成 SVG
- **AND** 不限制使用次数
- **AND** 不增加使用计数

#### Scenario: 未登录用户访问
- **WHEN** 未登录用户请求生成 SVG
- **THEN** 系统返回 401 未授权错误
- **AND** 要求用户先登录

### Requirement: 用户使用次数管理
系统 SHALL 支持管理员管理用户的使用次数限制。

#### Scenario: 查看用户使用情况
- **WHEN** 管理员查看用户信息
- **THEN** 系统显示用户当前使用次数和剩余次数
- **AND** 显示用户是否为永久用户

#### Scenario: 设置用户为永久用户
- **WHEN** 管理员将用户设置为永久用户
- **THEN** 系统标记用户为永久用户
- **AND** 该用户不再受使用次数限制

#### Scenario: 重置用户使用次数
- **WHEN** 管理员重置用户使用次数
- **THEN** 系统将用户使用次数重置为 0
- **AND** 用户可以重新使用 3 次

#### Scenario: 增加用户使用次数
- **WHEN** 管理员为用户增加使用次数
- **THEN** 系统增加用户的剩余使用次数
- **AND** 用户可以继续生成 SVG

### Requirement: 用户认证保护路由
系统 SHALL 保护 SVG 生成 API 路由，仅允许已登录用户访问。

#### Scenario: 未登录用户访问
- **WHEN** 未登录用户请求生成 SVG
- **THEN** 系统返回 401 未授权错误
- **AND** 要求用户先登录

#### Scenario: 用户认证中间件
- **WHEN** 请求到达受保护的路由
- **THEN** 系统首先验证用户登录状态
- **AND** 检查用户使用次数限制
- **AND** 仅当用户已登录且未超限时才处理请求

